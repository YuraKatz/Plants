<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Руководство по подкормкам - Plants Care</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f0f2f5;
            color: #1a202c;
            line-height: 1.5;
            padding: 20px;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #edf2f7;
        }
        h1 { font-size: 2.5rem; color: #2d3748; margin-bottom: 10px; }
        h2 { font-size: 1.5rem; color: #2d3748; margin: 30px 0 20px; }

        .nav-back {
            display: inline-block;
            margin-bottom: 20px;
            text-decoration: none;
            color: #4a5568;
            font-weight: 600;
            transition: color 0.2s;
        }
        .nav-back:hover { color: #2d3748; }

        .season-indicator {
            display: inline-block;
            padding: 10px 25px;
            border-radius: 30px;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-size: 1.2rem;
            margin-top: 10px;
        }
        .season-growth { background: #c6f6d5; color: #22543d; border: 2px solid #38a169; }
        .season-slow { background: #feebc8; color: #744210; border: 2px solid #dd6b20; }

        /* Legend */
        .legend {
            background: #f7fafc;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
        }
        .legend h3 {
            margin-bottom: 15px;
            color: #2d3748;
        }
        .legend-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        .dose-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            min-width: 50px;
            padding: 4px 10px;
            border-radius: 6px;
            font-weight: 700;
            font-size: 0.85rem;
        }
        .dose-full { background: #c6f6d5; color: #22543d; }
        .dose-half { background: #fef3c7; color: #92400e; }
        .dose-quarter { background: #fed7aa; color: #9a3412; }
        .dose-eighth { background: #fecaca; color: #991b1b; }
        .dose-forbidden { background: #fee2e2; color: #991b1b; }
        .dose-top { background: #e0e7ff; color: #3730a3; }

        /* Matrix Table */
        .matrix-container {
            overflow-x: auto;
            margin-bottom: 40px;
        }
        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }
        .matrix-table th {
            background: #2d3748;
            color: white;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        .matrix-table th:first-child {
            text-align: left;
            min-width: 200px;
        }
        .matrix-table td {
            padding: 10px 8px;
            text-align: center;
            border-bottom: 1px solid #e2e8f0;
        }
        .matrix-table td:first-child {
            text-align: left;
            font-weight: 500;
        }
        .matrix-table tr:hover {
            background: #f7fafc;
        }
        .matrix-table .plant-cell {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .matrix-table .plant-thumb {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            object-fit: cover;
        }
        .matrix-table .plant-info {
            display: flex;
            flex-direction: column;
        }
        .matrix-table .plant-name {
            font-weight: 600;
            color: #2d3748;
        }
        .matrix-table .plant-latin {
            font-size: 0.75rem;
            color: #718096;
            font-style: italic;
        }

        /* Water rules */
        .water-rules {
            margin-top: 40px;
            padding: 25px;
            background: #ebf8ff;
            border-radius: 15px;
            border-left: 6px solid #3182ce;
        }
        .water-rules h2 { color: #2c5282; margin: 0 0 15px 0; }
        .water-rules ul { list-style: none; }
        .water-rules li { margin-bottom: 10px; font-size: 1rem; }
        .water-rules li b { color: #2c5282; }

        /* Fertilizer info */
        .fertilizer-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .fertilizer-card {
            background: #f7fafc;
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #48bb78;
        }
        .fertilizer-card h4 {
            color: #2d3748;
            margin-bottom: 10px;
        }
        .fertilizer-card p {
            font-size: 0.9rem;
            color: #4a5568;
        }

        @media (max-width: 768px) {
            .container { padding: 20px; }
            h1 { font-size: 1.8rem; }
            .legend-grid { flex-direction: column; }
            .matrix-table { font-size: 0.8rem; }
            .matrix-table .plant-thumb { width: 30px; height: 30px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="nav-back">← На главную</a>
        <header>
            <h1>Руководство по подкормкам</h1>
            <div id="seasonIndicator" class="season-indicator">Режим: ЗАГРУЗКА...</div>
        </header>

        <!-- Legend -->
        <div class="legend">
            <h3>Обозначения дозировок</h3>
            <div class="legend-grid">
                <div class="legend-item">
                    <span class="dose-badge dose-full">100%</span>
                    <span>Полная доза</span>
                </div>
                <div class="legend-item">
                    <span class="dose-badge dose-half">1/2</span>
                    <span>Половина дозы</span>
                </div>
                <div class="legend-item">
                    <span class="dose-badge dose-quarter">1/4</span>
                    <span>Четверть дозы</span>
                </div>
                <div class="legend-item">
                    <span class="dose-badge dose-eighth">1/8</span>
                    <span>Минимальная доза</span>
                </div>
                <div class="legend-item">
                    <span class="dose-badge dose-top">top</span>
                    <span>Только сверху</span>
                </div>
                <div class="legend-item">
                    <span class="dose-badge dose-forbidden">—</span>
                    <span>Запрещено</span>
                </div>
            </div>
        </div>

        <!-- Matrix Table -->
        <h2>Таблица подкормок</h2>
        <div class="matrix-container">
            <table class="matrix-table" id="matrixTable">
                <thead>
                    <tr>
                        <th>Растение</th>
                        <th>Universal</th>
                        <th>Flowering</th>
                        <th>Multicote</th>
                    </tr>
                </thead>
                <tbody id="matrixBody">
                </tbody>
            </table>
        </div>

        <!-- Fertilizer Info -->
        <h2>Удобрения</h2>
        <div class="fertilizer-info">
            <div class="fertilizer-card">
                <h4>Flower Universal</h4>
                <p>Универсальное жидкое удобрение NPK 5-5-7. Подходит для большинства растений в период активного роста.</p>
            </div>
            <div class="fertilizer-card">
                <h4>Flower Flowering</h4>
                <p>Удобрение для цветущих растений с повышенным содержанием фосфора и калия. Стимулирует цветение.</p>
            </div>
            <div class="fertilizer-card" style="border-left-color: #805ad5;">
                <h4>Ecogan Multicote</h4>
                <p>Гранулированное удобрение пролонгированного действия. НЕ использовать на фитильном поливе!</p>
            </div>
        </div>

        <!-- Water Rules -->
        <div class="water-rules">
            <h2>Правила полива (всегда)</h2>
            <ul>
                <li><b>Cal-Mag:</b> Используйте только с RO (осмос) водой для предотвращения дефицита минералов.</li>
                <li><b>pH Down:</b> Регулируйте pH только если измеренное значение вне диапазона 5.8-6.2.</li>
                <li><b>Хищники:</b> ТОЛЬКО чистый RO (TDS < 10), никаких добавок и удобрений.</li>
                <li><b>Multicote:</b> Запрещён для растений на фитильном поливе — вымывается и вызывает ожог корней.</li>
            </ul>
        </div>
    </div>

    <script>
        const plantsData = {
            settings: { current_season: "growth" },
            feeding_matrix: {
                aroids: {
                    growth: { flower_universal: "allowed", flower_flowering: "allowed", ecogan_multicote: "allowed", atami_calmag: "allowed" },
                    slow: { flower_universal: "1/2", flower_flowering: "forbidden", ecogan_multicote: "forbidden", atami_calmag: "allowed" }
                },
                sensitive: {
                    growth: { flower_universal: "1/4", flower_flowering: "forbidden", ecogan_multicote: "top", atami_calmag: "allowed" },
                    slow: { flower_universal: "forbidden", flower_flowering: "forbidden", ecogan_multicote: "forbidden", atami_calmag: "allowed" }
                },
                orchids: {
                    growth: { flower_universal: "1/8", flower_flowering: "1/8", ecogan_multicote: "forbidden", atami_calmag: "1/4" },
                    slow: { flower_universal: "forbidden", flower_flowering: "forbidden", ecogan_multicote: "forbidden", atami_calmag: "allowed" }
                },
                carnivorous: {
                    growth: { flower_universal: "forbidden", flower_flowering: "forbidden", ecogan_multicote: "forbidden", atami_calmag: "forbidden" },
                    slow: { flower_universal: "forbidden", flower_flowering: "forbidden", ecogan_multicote: "forbidden", atami_calmag: "forbidden" }
                },
                general_houseplants: {
                    growth: { flower_universal: "allowed", flower_flowering: "allowed", ecogan_multicote: "allowed", atami_calmag: "allowed" },
                    slow: { flower_universal: "1/2", flower_flowering: "forbidden", ecogan_multicote: "forbidden", atami_calmag: "allowed" }
                }
            },
            plants: {
                monstera_deliciosa: { name: "Монстера делициоза", latin: "Monstera deliciosa", group: "aroids", wick: true },
                monstera_adansonii: { name: "Монстера адансони", latin: "Monstera adansonii", group: "aroids", wick: true },
                philodendron: { name: "Филодендрон", latin: "Philodendron", group: "aroids", wick: true },
                epipremnum: { name: "Эпипремнум", latin: "Epipremnum aureum", group: "aroids", wick: true },
                aglaonema: { name: "Аглаонема", latin: "Aglaonema", group: "aroids", wick: true },
                spathiphyllum: { name: "Спатифиллум", latin: "Spathiphyllum", group: "aroids", wick: true },
                calathea_lancifolia: { name: "Калатея лансифолия", latin: "Calathea lancifolia", group: "sensitive", wick: true },
                calathea_ornata: { name: "Калатея орната", latin: "Calathea ornata", group: "sensitive", wick: true },
                alocasia_amazonica: { name: "Алоказия", latin: "Alocasia amazonica", group: "sensitive", wick: true },
                anthurium_andraeanum: { name: "Антуриум", latin: "Anthurium andraeanum", group: "sensitive", wick: true },
                guzmania: { name: "Гузмания", latin: "Guzmania", group: "sensitive", wick: false },
                nephrolepis: { name: "Папоротник", latin: "Nephrolepis exaltata", group: "sensitive", wick: false },
                phalaenopsis: { name: "Орхидея", latin: "Phalaenopsis", group: "orchids", wick: false },
                dracaena_marginata: { name: "Драцена маргината", latin: "Dracaena marginata", group: "general_houseplants", wick: false },
                dracaena_fragrans: { name: "Драцена фрагранс", latin: "Dracaena fragrans", group: "general_houseplants", wick: false },
                croton: { name: "Кротон", latin: "Codiaeum variegatum", group: "general_houseplants", wick: true },
                begonia_maculata: { name: "Бегония макулата", latin: "Begonia maculata", group: "general_houseplants", wick: true },
                chamaedorea: { name: "Хамедорея", latin: "Chamaedorea", group: "general_houseplants", wick: false },
                chlorophytum_comosum: { name: "Хлорофитум", latin: "Chlorophytum comosum", group: "general_houseplants", wick: true },
                sansevieria: { name: "Сансевиерия", latin: "Sansevieria trifasciata", group: "general_houseplants", wick: false },
                dionaea: { name: "Дионея", latin: "Dionaea muscipula", group: "carnivorous", wick: false }
            }
        };

        const imageMap = {
            "aglaonema": "IMAGES/Аглаонема.jpeg",
            "alocasia_amazonica": "IMAGES/Алоказия.jpg",
            "anthurium_andraeanum": "IMAGES/Антуриум.jpg",
            "begonia_maculata": "IMAGES/Бегония макулата.jpg",
            "guzmania": "IMAGES/Гузмания.jpg",
            "dracaena_marginata": "IMAGES/Драцена маргината.jpg",
            "dracaena_fragrans": "IMAGES/Драцена фрагранс.jpg",
            "calathea_lancifolia": "IMAGES/Калатея лансифолия.jpg",
            "calathea_ornata": "IMAGES/алатея орната.jpg",
            "croton": "IMAGES/Кротон.jpg",
            "monstera_adansonii": "IMAGES/Монстера адансони.jpeg",
            "monstera_deliciosa": "IMAGES/Монстера делициоза.jpg",
            "phalaenopsis": "IMAGES/Орхидея.jpg",
            "spathiphyllum": "IMAGES/Спатифиллум.jpg",
            "chamaedorea": "IMAGES/Хамедорея.jpg",
            "chlorophytum_comosum": "IMAGES/Хлорофитум.jpg",
            "epipremnum": "IMAGES/пипремнум.jpg",
            "philodendron": "IMAGES/филодендрон imperial.jpg",
            "dionaea": "IMAGES/Дионея.jpg",
            "nephrolepis": "IMAGES/ПапоротникНефролепис.jpeg",
            "sansevieria": "IMAGES/Сансевиерия.jpg"
        };

        // Season indicator
        const season = plantsData.settings.current_season;
        const indicator = document.getElementById('seasonIndicator');
        if (season === 'growth') {
            indicator.textContent = 'Режим: РОСТ (Весна/Лето)';
            indicator.className = 'season-indicator season-growth';
        } else {
            indicator.textContent = 'Режим: ПОКОЙ (Осень/Зима)';
            indicator.className = 'season-indicator season-slow';
        }

        // Build matrix table
        function getDoseBadge(status, isWick, fertType) {
            // Multicote forbidden for wick watering plants
            if (fertType === 'ecogan_multicote' && isWick) {
                return '<span class="dose-badge dose-forbidden" title="Запрещено на фитиле">—</span>';
            }

            if (status === 'forbidden') {
                return '<span class="dose-badge dose-forbidden">—</span>';
            } else if (status === 'allowed') {
                return '<span class="dose-badge dose-full">100%</span>';
            } else if (status === '1/2') {
                return '<span class="dose-badge dose-half">1/2</span>';
            } else if (status === '1/4') {
                return '<span class="dose-badge dose-quarter">1/4</span>';
            } else if (status === '1/8') {
                return '<span class="dose-badge dose-eighth">1/8</span>';
            } else if (status === 'top') {
                return '<span class="dose-badge dose-top">top</span>';
            }
            return '<span class="dose-badge dose-full">100%</span>';
        }

        const tbody = document.getElementById('matrixBody');

        // Sort plants by group for better organization
        const groupOrder = ['aroids', 'sensitive', 'orchids', 'general_houseplants', 'carnivorous'];
        const sortedPlants = Object.entries(plantsData.plants).sort((a, b) => {
            return groupOrder.indexOf(a[1].group) - groupOrder.indexOf(b[1].group);
        });

        let currentGroup = '';
        sortedPlants.forEach(([id, plant]) => {
            const matrix = plantsData.feeding_matrix[plant.group][season];
            const img = imageMap[id] || '';

            // Add group separator
            if (plant.group !== currentGroup) {
                currentGroup = plant.group;
                const groupNames = {
                    aroids: 'Ароидные',
                    sensitive: 'Чувствительные',
                    orchids: 'Орхидеи',
                    general_houseplants: 'Общие комнатные',
                    carnivorous: 'Хищные'
                };
                const groupRow = document.createElement('tr');
                groupRow.innerHTML = `<td colspan="4" style="background: #edf2f7; font-weight: 700; color: #4a5568; padding: 8px 12px;">${groupNames[currentGroup]}</td>`;
                tbody.appendChild(groupRow);
            }

            const row = document.createElement('tr');
            row.innerHTML = `
                <td>
                    <div class="plant-cell">
                        <img src="${img}" class="plant-thumb" alt="${plant.name}" onerror="this.style.display='none'">
                        <div class="plant-info">
                            <span class="plant-name">${plant.name}</span>
                            <span class="plant-latin">${plant.latin}</span>
                        </div>
                    </div>
                </td>
                <td>${getDoseBadge(matrix.flower_universal, plant.wick, 'flower_universal')}</td>
                <td>${getDoseBadge(matrix.flower_flowering, plant.wick, 'flower_flowering')}</td>
                <td>${getDoseBadge(matrix.ecogan_multicote, plant.wick, 'ecogan_multicote')}</td>
            `;
            tbody.appendChild(row);
        });
    </script>
</body>
</html>
